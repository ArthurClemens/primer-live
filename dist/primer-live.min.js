var C=Object.defineProperty,H=Object.defineProperties,N=Object.getOwnPropertyDescriptors,E=Object.getOwnPropertySymbols,V=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,O=(e,t,r)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_=(e,t)=>{for(var r in t||(t={}))V.call(t,r)&&O(e,r,t[r]);if(E)for(var r of E(t))x.call(t,r)&&O(e,r,t[r]);return e},k=(e,t)=>H(e,N(t)),u=(e,t,r)=>new Promise((i,a)=>{var o=n=>{try{c(r.next(n))}catch(d){a(d)}},l=n=>{try{c(r.throw(n))}catch(d){a(d)}},c=n=>n.done?i(n.value):Promise.resolve(n.value).then(o,l);c((r=r.apply(e,t)).next())}),I=e=>new Promise(t=>setTimeout(t,e)),M=(e,t)=>t.reduce((r,i)=>r!=="0s"?r:e.getPropertyValue(i),"0s"),b=({domElement:e,props:t})=>{let r=document.defaultView;if(r){let i=r.getComputedStyle(e);if(i)return M(i,t)}},L=e=>{let t=parseFloat(e)*(e.indexOf("ms")===-1?1e3:1);return Number.isNaN(t)?0:t},m=e=>{let t=b({domElement:e,props:["animation-duration","transition-duration"]}),r=t!==void 0?L(t):0,i=b({domElement:e,props:["animation-delay","transition-delay"]}),a=i!==void 0?L(i):0;return r+a},R=e=>e.scrollTop,q=e=>{let t=window.getComputedStyle(e);return t.opacity==="0"||t.display==="none"?!1:!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},j=(e,t)=>e instanceof HTMLAnchorElement&&e.rel!=="ignore"||e instanceof HTMLAreaElement&&e.href!==void 0||[HTMLInputElement,HTMLSelectElement,HTMLTextAreaElement,HTMLButtonElement].some(r=>e instanceof r)&&!e.disabled||e instanceof HTMLIFrameElement||e.tabIndex>0||!t&&e.tabIndex===0&&e.getAttribute("tabindex")!==null&&e.getAttribute("aria-hidden")!=="true",U=e=>[].slice.call(e.querySelectorAll("button, [href], input, select, textarea, [tabindex]:not([tabindex='-1'])")).filter(r=>j(r,!0)).sort((r,i)=>r.tabIndex-i.tabIndex)[0],G=(e,t,r)=>{t&&(e[t]||(e[t]=JSON.stringify(r)))},B=(e,t)=>{if(t)return JSON.parse(e[t])},A=(e,t)=>{t&&delete e[t]},J=(e,t)=>{!t||!e||Object.keys(e).forEach(r=>{t.dataset[r]=e[r]})},D="[data-prompt]",K="[data-content]",W="[data-touch]",$="[data-toggle]",z="ismodal",Q="isescapable",X="isfocusfirst",Y="focusfirst",w="isopen",F="isshowing",P="ishiding",p="islocked",Z=300,g=(e,...t)=>u(void 0,[e,...t],function*(r,i={}){let{content:a,root:o,isDetails:l,isEscapable:c,escapeListener:n}=r;if(o.dataset[p]!==void 0&&!i.isIgnoreLockDuration)return;i.willHide&&i.willHide(r),delete o.dataset[F],o.dataset[P]="";let d=m(a);yield I(d),l&&o.removeAttribute("open"),delete o.dataset[P],delete o.dataset[w],i.didHide&&i.didHide(r),c&&window.removeEventListener("keydown",n)}),S=(e,...t)=>u(void 0,[e,...t],function*(r,i={}){let{content:a,root:o,isDetails:l,isEscapable:c,isFocusFirst:n,focusFirstSelector:d,escapeListener:y}=r;if(o.dataset[p]!==void 0)return;o.dataset[p]="",setTimeout(()=>{o&&delete o.dataset[p]},Z),c&&window.addEventListener("keydown",y),l&&o.setAttribute("open",""),o.dataset[w]="",R(o),o.dataset[F]="",i.willShow&&i.willShow(r);let h=m(a);if(yield I(h),n){let s=U(a);s&&s.focus()}else if(d){let s=a.querySelector(d);s&&s.focus()}i.didShow&&i.didShow(r)}),T=(e,...t)=>u(void 0,[e,...t],function*(r,i=2,a){switch(i){case 0:return yield S(r,a);case 1:return yield g(r,a);default:return q(r.content)?yield g(r,a):yield S(r,a)}}),ee=(e,t,r)=>{let i=null;if(!t&&e?i=e:typeof t=="string"?i=document.querySelector(t):t&&t.tagName&&(i=t.closest(D)),!i){console.error("Prompt element 'data-root' not found");return}let a=i.querySelector(K);if(!a){console.error("Prompt element 'data-content' not found");return}let o=i.querySelector($)||i.querySelector("summary"),l=i.querySelector(W),c=i.tagName==="DETAILS",n=i.dataset[z]!==void 0,d=i.dataset[Q]!==void 0,y=i.dataset[X]!==void 0,h=i.dataset[Y],s={root:i,isDetails:c,isModal:n,isEscapable:d,isFocusFirst:y,focusFirstSelector:h,toggle:o,content:a,touchLayer:l,escapeListener:function(f){f.key==="Escape"&&[].slice.call(document.querySelectorAll(`${D}[data-${w}]`)).reverse()[0]===s.root&&g(s,k(_({},r),{isIgnoreLockDuration:!0}))},clickTouchLayerListener:function(f){f.target===l&&(f.stopPropagation(),n||T(s,1,r))},clickToggleListener:function(f){f.preventDefault(),f.stopPropagation(),T(s,void 0,r)}};return s},te=e=>{let{toggle:t,clickToggleListener:r}=e;t&&t.dataset.registered!==""&&(t.addEventListener("click",r),t.dataset.registered="")},re=e=>{let{clickTouchLayerListener:t,touchLayer:r}=e;r&&r.dataset.registered!==""&&(r.addEventListener("click",t),r.dataset.registered="")};function v(e,t,r,i){return u(this,null,function*(){e.options=_(_({},e.options),r);let a=ee(e.el,t,e.options);if(a===void 0)return;e.el||(e.el=a==null?void 0:a.root),te(a),re(a);let{root:o,isDetails:l}=a;l&&o.getAttribute("open")!==null&&i!==1&&S(a,e.options),i!==void 0&&(yield T(a,i,e.options))})}var ie={_cache:{},mounted(){},beforeUpdate(){var e,t;G(this._cache,(e=this.el)==null?void 0:e.id,(t=this.el)==null?void 0:t.dataset)},updated(){var e,t;let r=B(this._cache,(e=this.el)==null?void 0:e.id);J(r,this.el),A(this._cache,(t=this.el)==null?void 0:t.id)},destroyed(){var e;A(this._cache,(e=this.el)==null?void 0:e.id)},init(e,t){return u(this,null,function*(){yield v(this,e,t)})},toggle(e,t){return u(this,null,function*(){yield v(this,e,t,2)})},show(e,t){return u(this,null,function*(){yield v(this,e,t,0)})},hide(e,t){return u(this,null,function*(){yield v(this,e,t,1)})}};window.Prompt=ie;export{ie as Prompt};
